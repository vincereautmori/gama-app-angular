"use strict";(self.webpackChunkgama_app=self.webpackChunkgama_app||[]).push([[69],{1069:(V,F,o)=>{o.r(F),o.d(F,{FineModule:()=>h});var t=o(4650),p=o(6895),c=o(221),b=o(2216),l=o(4006),U=o(9627),M=o(769),I=o(247),u=o(1489),_=o(5439),x=o(8505),P=o(6271),S=o(529),q=o(7185);class d{constructor(e,n,a){this.http=e,this.router=n,this.toastr=a,this.baseUrl=P._.API_URL_PREFFIX,this.basePrefix="traffic-fines"}getAll(e){return this.http.get(`${this.baseUrl}/${this.basePrefix}`,{params:{pageNumber:e.page,createdSince:e.createdSince,...e.licensePlate?{licensePlate:e.licensePlate}:{},createdUntil:e.createdUntil}})}getById(e){return this.http.get(`${this.baseUrl}/${this.basePrefix}/${e}`)}create(e){return this.http.post(`${this.baseUrl}/${this.basePrefix}/${this.basePrefix}`,e,{observe:"response"}).pipe((0,x.b)(n=>{200===n.status&&this.toastr.show("Cadastro efetuado com sucesso","200")}))}update(e,n){return this.http.put(`${this.baseUrl}/${this.basePrefix}/${e}`,n)}compute(e){return this.http.post(`${this.baseUrl}/${this.basePrefix}/${e}/compute`,null).pipe((0,x.b)(n=>{200===n.status&&this.toastr.show("Cadastro efetuado com sucesso","200")}))}delete(e){return this.http.delete(`${this.baseUrl}/${this.basePrefix}/${e}`)}}d.\u0275fac=function(e){return new(e||d)(t.LFG(S.eN),t.LFG(u.F0),t.LFG(q._W))},d.\u0275prov=t.Yz7({token:d,factory:d.\u0275fac,providedIn:"root"});var y=o(6942);class g extends p.uU{constructor(e){super(e,null)}transform(e,n,a,s){return super.transform("string"==typeof e?e:e?.toISOString(),n,a,s)}}function J(i,e){1&i&&t._UZ(0,"fa-icon",25)}function N(i,e){1&i&&t._UZ(0,"fa-icon",26)}function Y(i,e){if(1&i){const n=t.EpF();t.TgZ(0,"tr")(1,"th",20),t._uU(2),t.qZA(),t.TgZ(3,"td"),t.YNc(4,J,1,0,"fa-icon",21),t.YNc(5,N,1,0,"fa-icon",22),t.qZA(),t.TgZ(6,"td"),t._uU(7),t.qZA(),t.TgZ(8,"td"),t._uU(9),t.ALo(10,"dateMoment"),t.qZA(),t.TgZ(11,"td")(12,"button",23),t.NdJ("click",function(){const r=t.CHM(n).$implicit,A=t.oxw();return t.KtG(A.goToView(r))}),t._UZ(13,"fa-icon",24),t.qZA()()()}if(2&i){const n=e.$implicit;t.xp6(2),t.Oqu(n.id),t.xp6(2),t.Q6J("ngIf",!n.active),t.xp6(1),t.Q6J("ngIf",n.active),t.xp6(2),t.hij(" ",n.licensePlate," "),t.xp6(2),t.hij(" ",t.xi3(10,5,n.createdAt,"dd/MM/yy HH:mm")," ")}}function w(i,e){1&i&&(t.TgZ(0,"p")(1,"ngb-alert",27)(2,"strong"),t._uU(3,"N\xe3o h\xe1 dados cadastrados"),t.qZA()()()),2&i&&(t.xp6(1),t.Q6J("dismissible",!1))}function D(i,e){1&i&&t._UZ(0,"span",32)}g.\u0275fac=function(e){return new(e||g)(t.Y36(t.soG,16))},g.\u0275pipe=t.Yjl({name:"dateMoment",type:g,pure:!1});const O=function(i){return{"with-pagination":i}};function z(i,e){if(1&i){const n=t.EpF();t.TgZ(0,"div",28)(1,"div",29),t.YNc(2,D,1,0,"span",30),t.TgZ(3,"div"),t._uU(4),t.qZA(),t.TgZ(5,"ngb-pagination",31),t.NdJ("pageChange",function(s){t.CHM(n);const r=t.oxw();return t.KtG(r.page=s)})("pageChange",function(){t.CHM(n);const s=t.oxw();return t.KtG(s.loadPage(s.page))}),t.qZA()()()}if(2&i){const n=t.oxw();t.Q6J("ngClass",t.VKq(10,O,n.fines)),t.xp6(2),t.Q6J("ngIf",!n.fines.length),t.xp6(2),t.AsE(" Mostrando ",n.fines.length," de ",n.totalItems," "),t.xp6(1),t.Q6J("collectionSize",n.totalItems)("page",n.page)("pageSize",n.pageSize)("maxSize",5)("rotate",!0)("boundaryLinks",!0)}}class Z{constructor(e,n,a,s){this.fb=e,this.router=n,this.fineService=a,this.genericModalService=s,this.page=1,this.totalItems=1,this.pageSize=10,this.from=_(new Date(2023,1,1)),this.to=_(new Date(2023,12,31)),this.fines=[],this.dateForm=this.fb.group({from:[""],to:[""],licensePlate:[""]})}confirmDelete(e){this.genericModalService.show("Remover multa","Tem certeza que deseja desativar o fineistrador?",()=>{this.delete(e)})}new(){this.router.navigate(["fines/new"])}goToEdit(e){this.router.navigate(["fines",e.id,"edit"])}goToView(e){this.router.navigate(["fines",e.id,"view"])}ngOnInit(){this.loadAll(),this.dateForm.get(["from"])?.setValue(this.from),this.dateForm.get(["to"])?.setValue(this.from)}loadAll(){this.fineService.getAll({licensePlate:this.licensePlate,page:this.page,createdSince:this.from?.toISOString().split("T")[0],createdUntil:this.to.toISOString().split("T")[0]}).subscribe(e=>{this.fines=e?.results||[],this.page=e?.pageNumber||0,this.totalItems=e?.count||0,this.pageSize=e?.size||0,this.fines?.map(n=>{n.createdAt=_(n.createdAt)})})}delete(e){this.fineService.delete(e.id).subscribe(n=>{this.loadAll()})}previousPage(){this.page--,this.loadAll()}nextPage(){this.page++,this.loadAll()}loadPage(e){this.page=e,this.loadAll()}search(){const e=this.dateForm.get(["from"]).value,n=this.dateForm.get(["to"]).value;this.licensePlate=this.dateForm.get(["licensePlate"]).value,this.from=_(new Date(e.year,e.month-1,e.day)),this.to=_(new Date(n.year,n.month-1,n.day)),this.loadAll()}}Z.\u0275fac=function(e){return new(e||Z)(t.Y36(l.qu),t.Y36(u.F0),t.Y36(d),t.Y36(y.v))},Z.\u0275cmp=t.Xpm({type:Z,selectors:[["app-fine"]],decls:43,vars:4,consts:[[1,"component-header"],[1,"container"],[1,"row","row-cols-sm-auto","mb-4",3,"formGroup","submit"],[1,"col-6"],[1,"form-group","col-12"],[1,"input-group"],["placeholder","01-01-2023","formControlName","from","name","dp","ngbDatepicker","",1,"form-control"],["d","ngbDatepicker"],["type","button",1,"btn","btn-outline-secondary","bi","bi-calendar3",3,"click"],["icon","calendar"],["placeholder","31-12-2023","formControlName","to","name","dp2","ngbDatepicker","",1,"form-control"],["d2","ngbDatepicker"],["formControlName","licensePlate","placeholder","Placa",1,"search-btn","form-control"],["type","submit",1,"btn","btn-primary","search-btn"],["icon","search"],[1,"table","table-striped"],["scope","col"],[4,"ngFor","ngForOf"],[4,"ngIf"],["class","card-header",3,"ngClass",4,"ngIf"],["scope","row"],["class","danger","icon","close",4,"ngIf"],["class","success","icon","check",4,"ngIf"],["type","button",1,"btn","btn-primary",3,"click"],["icon","eye"],["icon","close",1,"danger"],["icon","check",1,"success"],[3,"dismissible"],[1,"card-header",3,"ngClass"],[1,"d-flex","justify-content-between"],["jhiTranslate","global.empty.list.title",4,"ngIf"],["size","sm",3,"collectionSize","page","pageSize","maxSize","rotate","boundaryLinks","pageChange"],["jhiTranslate","global.empty.list.title"]],template:function(e,n){if(1&e){const a=t.EpF();t.TgZ(0,"div",0)(1,"h2"),t._uU(2,"Multas"),t.qZA()(),t.TgZ(3,"div",1)(4,"form",2),t.NdJ("submit",function(){return n.search()}),t.TgZ(5,"div",3)(6,"div",4)(7,"label"),t._uU(8,"De"),t.qZA(),t.TgZ(9,"div",5),t._UZ(10,"input",6,7),t.TgZ(12,"button",8),t.NdJ("click",function(){t.CHM(a);const r=t.MAs(11);return t.KtG(r.toggle())}),t._UZ(13,"fa-icon",9),t.qZA()()()(),t.TgZ(14,"div",3)(15,"div",4)(16,"label"),t._uU(17,"At\xe9"),t.qZA(),t.TgZ(18,"div",5),t._UZ(19,"input",10,11),t.TgZ(21,"button",8),t.NdJ("click",function(){t.CHM(a);const r=t.MAs(20);return t.KtG(r.toggle())}),t._UZ(22,"fa-icon",9),t.qZA()()()(),t.TgZ(23,"div",3),t._UZ(24,"input",12),t.qZA(),t.TgZ(25,"button",13),t._UZ(26,"fa-icon",14),t._uU(27,"\xa0 Pesquisar"),t.qZA()(),t.TgZ(28,"table",15)(29,"thead")(30,"tr")(31,"th",16),t._uU(32,"#"),t.qZA(),t.TgZ(33,"th",16),t._uU(34,"Ativo"),t.qZA(),t.TgZ(35,"th",16),t._uU(36,"Placa"),t.qZA(),t.TgZ(37,"th",16),t._uU(38,"Data"),t.qZA()()(),t.TgZ(39,"tbody"),t.YNc(40,Y,14,8,"tr",17),t.qZA()(),t.YNc(41,w,4,1,"p",18),t.YNc(42,z,6,12,"div",19),t.qZA()}2&e&&(t.xp6(4),t.Q6J("formGroup",n.dateForm),t.xp6(36),t.Q6J("ngForOf",n.fines),t.xp6(1),t.Q6J("ngIf",!(null!=n.fines&&n.fines.length)),t.xp6(1),t.Q6J("ngIf",n.totalItems>0))},dependencies:[p.mk,p.sg,p.O5,c.N9,l._Y,l.Fj,l.JJ,l.JL,l.sg,l.u,c.J4,b.BN,c.xm,g],styles:[".success[_ngcontent-%COMP%]{color:green}.danger[_ngcontent-%COMP%]{color:red}.search-btn[_ngcontent-%COMP%]{margin-top:38px}.map[_ngcontent-%COMP%]{width:100%;height:600px}"]});var C=o(6760),T=o(9898),$=o(2248),G=o(1481);const Q=["form"];function k(i,e){1&i&&(t._UZ(0,"fa-icon",16),t._uU(1," \xa0 "),t.TgZ(2,"span"),t._uU(3,"Detalhes"),t.qZA()),2&i&&t.Q6J("fixedWidth",!0)}function L(i,e){1&i&&t._UZ(0,"fa-icon",21)}function j(i,e){1&i&&t._UZ(0,"fa-icon",22)}function B(i,e){if(1&i&&(t.TgZ(0,"dd"),t._uU(1),t.qZA()),2&i){const n=e.$implicit;t.xp6(1),t.Oqu(n.name)}}function E(i,e){if(1&i&&(t.TgZ(0,"div",7)(1,"dl",10)(2,"dt")(3,"span"),t._uU(4,"Id"),t.qZA()(),t.TgZ(5,"dd"),t._uU(6),t.qZA(),t.TgZ(7,"dt")(8,"span"),t._uU(9,"Placa"),t.qZA()(),t.TgZ(10,"dd"),t._uU(11),t.qZA(),t.TgZ(12,"dt")(13,"span"),t._uU(14,"Data"),t.qZA()(),t.TgZ(15,"dd"),t._uU(16),t.ALo(17,"dateMoment"),t.qZA(),t.TgZ(18,"dt")(19,"span"),t._uU(20,"Computado"),t.qZA()(),t.TgZ(21,"dd"),t.YNc(22,L,1,0,"fa-icon",17),t.YNc(23,j,1,0,"fa-icon",18),t.qZA(),t.TgZ(24,"dt"),t._uU(25,"Latitude"),t.qZA(),t.TgZ(26,"dd"),t._uU(27),t.qZA(),t.TgZ(28,"dt")(29,"span"),t._uU(30,"Longitude"),t.qZA()(),t.TgZ(31,"dd"),t._uU(32),t.qZA(),t.TgZ(33,"dt")(34,"span"),t._uU(35,"Infra\xe7oes"),t.qZA()(),t.YNc(36,B,2,1,"dd",19),t.TgZ(37,"dt")(38,"span"),t._uU(39,"Imagem"),t.qZA()(),t.TgZ(40,"dd"),t._UZ(41,"img",20),t.qZA()()()),2&i){const n=t.oxw(2);t.xp6(6),t.Oqu(n.fine.id),t.xp6(5),t.Oqu(n.fine.licensePlate),t.xp6(5),t.Oqu(t.xi3(17,9,n.fine.createdAt,"dd/MM/yyyy hh:MM")),t.xp6(6),t.Q6J("ngIf",!n.fine.computed),t.xp6(1),t.Q6J("ngIf",n.fine.computed),t.xp6(4),t.Oqu(n.fine.latitude),t.xp6(5),t.Oqu(n.fine.longitude),t.xp6(4),t.Q6J("ngForOf",n.fine.trafficViolations),t.xp6(5),t.Q6J("src",n.image,t.LSH)}}function H(i,e){1&i&&(t.TgZ(0,"div",10)(1,"div",11)(2,"div",7)(3,"ngb-accordion",12)(4,"ngb-panel",13),t.YNc(5,k,4,1,"ng-template",14),t.YNc(6,E,42,12,"ng-template",15),t.qZA()()()()())}class v{constructor(e,n,a,s,r,A,R){this.fb=e,this.fineService=n,this.genericModalService=a,this.fileService=s,this.router=r,this.route=A,this.sanitizer=R,this.style="mapbox://styles/mapbox/streets-v11",this.fine=this.route.snapshot.data.fine}ngOnInit(){this.fine=this.route.snapshot.data.fine,T.accessToken="pk.eyJ1IjoiZW5nZW5oZWlyb3Nkb3RpIiwiYSI6ImNsMWJmYWl2YTAyMGczam9hamw5bWw5dWUifQ.fEdX9brp2Sgd3wpAO5jKNA",this.map=new T.Map({container:"map",style:this.style,zoom:13,center:[this.fine.longitude,this.fine.latitude]}),this.fileService.get(this.fine.imageUrl).subscribe(n=>{this.image=this.sanitize("data:image/jpg;base64, "+this._arrayBufferToBase64(n))}),(new T.Marker).setLngLat([this.fine.longitude,this.fine.latitude]).addTo(this.map)}compute(){this.genericModalService.show("Computar multa","Tem certeza que deseja compultar a multa?",()=>{this.fineService.compute(this.fine?.id).subscribe(()=>{})})}sanitize(e){return this.sanitizer.bypassSecurityTrustUrl(e)}_arrayBufferToBase64(e){for(var n="",a=new Uint8Array(e),s=a.byteLength,r=0;r<s;r++)n+=String.fromCharCode(a[r]);return window.btoa(n)}cancel(){this.router.navigate(["/fines"])}}v.\u0275fac=function(e){return new(e||v)(t.Y36(l.qu),t.Y36(d),t.Y36(y.v),t.Y36($.I),t.Y36(u.F0),t.Y36(u.gz),t.Y36(G.H7))},v.\u0275cmp=t.Xpm({type:v,selectors:[["app-fine-detail"]],viewQuery:function(e,n){if(1&e&&t.Gf(Q,5),2&e){let a;t.iGM(a=t.CRH())&&(n.form=a.first)}},decls:14,vars:1,consts:[[1,"component-header"],[1,"container"],[1,"btn-header","mb-4"],[1,"btn-primary","btn",3,"click"],["icon","angle-left"],[1,"btn-warning","btn",3,"click"],["icon","computer"],[1,"row","justify-content-center"],["class","col-12",4,"ngIf"],["id","map",1,"match-parent",2,"height","300px","margin-bottom","40px"],[1,"col-12"],[1,"card-body"],["activeIds","panelEntity",1,"col-12","entity-details"],["id","panelEntity"],["ngbPanelTitle",""],["ngbPanelContent",""],["icon","list-alt",3,"fixedWidth"],["class","danger","icon","close",4,"ngIf"],["class","success","icon","check",4,"ngIf"],[4,"ngFor","ngForOf"],[2,"width","200px","height","auto",3,"src"],["icon","close",1,"danger"],["icon","check",1,"success"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"h2"),t._uU(2,"Detalhes da multa"),t.qZA()(),t.TgZ(3,"div",1)(4,"div",2)(5,"button",3),t.NdJ("click",function(){return n.cancel()}),t._UZ(6,"fa-icon",4),t._uU(7,"\xa0 Voltar"),t.qZA(),t.TgZ(8,"button",5),t.NdJ("click",function(){return n.compute()}),t._UZ(9,"fa-icon",6),t._uU(10,"\xa0 Computar"),t.qZA()(),t.TgZ(11,"div",7),t.YNc(12,H,7,0,"div",8),t.qZA(),t._UZ(13,"div",9),t.qZA()),2&e&&(t.xp6(12),t.Q6J("ngIf",n.fine))},dependencies:[p.sg,p.O5,c.gY,c.Gk,c.Cu,c.gW,b.BN,g],styles:[".success[_ngcontent-%COMP%]{color:green}.danger[_ngcontent-%COMP%]{color:red}.search-btn[_ngcontent-%COMP%]{margin-top:38px}.map[_ngcontent-%COMP%]{width:100%;height:600px}"]});class f{constructor(e,n){this.service=e,this.router=n}resolve(e){return this.service.getById(e.params.id)}}f.\u0275fac=function(e){return new(e||f)(t.LFG(d),t.LFG(u.F0))},f.\u0275prov=t.Yz7({token:f,factory:f.\u0275fac,providedIn:"root"});const W=[{path:"",component:Z,pathMatch:"full",canActivate:[C.a]},{path:":id/view",component:v,resolve:{fine:f},pathMatch:"full",canActivate:[C.a]}];class m{}m.\u0275fac=function(e){return new(e||m)},m.\u0275mod=t.oAB({type:m}),m.\u0275inj=t.cJS({imports:[u.Bz.forChild(W),u.Bz]}),(0,p.qS)(U.Z);class h{}h.\u0275fac=function(e){return new(e||h)},h.\u0275mod=t.oAB({type:h}),h.\u0275inj=t.cJS({providers:[{provide:t.soG,useValue:"pt-BR"}],imports:[p.ez,c.jF,c.Gs,l.UX,m,c.M,b.uH,M.zh,I.A0,c.IJ]})}}]);